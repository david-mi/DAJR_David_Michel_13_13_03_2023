<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Components/ProfileForm/ProfileForm.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Components/ProfileForm/ProfileForm.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState, useRef } from "react";
import { useSelector } from "react-redux";
import Loader from "../Loader/Loader";
import { fetchStatus } from "../../enums";
import styles from "./profileForm.module.css";
import { ProfileFormPropTypes } from "./propTypes";

/**
 * Profile modification form
 * 
 * @param {Object} props
 * @param {function(Object)} props.submitHandler handler to dispatch information to the store
 * @param {function()} props.closeForm handler to close form
 * @param {string} props.firstName
 * @param {string} props.lastName
 * @returns {JSX.Element}
 */

const ProfileForm = (props) => {
  const { firstName, lastName, closeForm, submitHandler } = props;
  const firstNameRef = useRef(null);
  const lastNameRef = useRef(null);
  const { status, error } = useSelector(({ profile }) => profile.edit);
  const [validationError, setValidationError] = useState(null);
  const isSendingRequest = status === fetchStatus.PENDING;
  const hasError = error || validationError;

  const namePattern = {
    required: true,
    type: "text",
    pattern: "^[a-zA-ZÀ-ö]{1}[a-z-À-ö ]*[a-zA-ZÀ-ö]{1}$",
    title: "Le prénom doit comporter au minimum 2 caractères, commencer et finir par une lettre",
    disabled: isSendingRequest
  };

  /**
   * Handle form submit
   * 
   * - if reportValidity returns true on the form, calls {@link submitHandler}
   * passing {@link formBody} as parameter
   * - if data didn't change, set an error and prevent submitting
   * 
   * @param {React.FormEvent} event 
   */

  function submitForm(event) {
    event.preventDefault();

    const formBody = {
      firstName: firstNameRef.current.value.trim(),
      lastName: lastNameRef.current.value.trim()
    };

    if (isDataUnchanged(formBody.firstName, formBody.lastName)) {
      return setValidationError("Les informations sont identiques");
    }

    if (event.target.reportValidity()) {
      submitHandler(formBody);
    }
  }

  /**
   * Verify if firstName and lastName didn't change on form submit
   * 
   * @param {string} firstNameUpdate 
   * @param {string} lastNameUpdate 
   * @returns {boolean}
   */

  function isDataUnchanged(firstNameUpdate, lastNameUpdate) {
    return firstNameUpdate === firstName &amp;&amp; lastNameUpdate === lastName;
  }

  return (
    &lt;form className={styles.form} onSubmit={submitForm}>
      &lt;input
        {...namePattern}
        placeholder="Prénom"
        className={styles.firstName}
        defaultValue={firstName}
        name="firstName"
        ref={firstNameRef}
      />
      &lt;input
        {...namePattern}
        placeholder="Nom"
        className={styles.lastName}
        defaultValue={lastName}
        name="lastName"
        ref={lastNameRef}
      />
      &lt;button className={styles.save} disabled={isSendingRequest}>
        Save
        {isSendingRequest &amp;&amp; &lt;Loader className={styles.loader} />}
      &lt;/button>
      &lt;button
        className={styles.cancel}
        onClick={closeForm}
        type="button"
        disabled={isSendingRequest}
      >
        Cancel
      &lt;/button>
      {hasError &amp;&amp; &lt;small className={styles.error}>{error || validationError}&lt;/small>}
    &lt;/form>
  );
};

ProfileForm.propTypes = ProfileFormPropTypes;

export default ProfileForm;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="MissingTokenError.html">MissingTokenError</a></li><li><a href="global.html#User">User</a></li><li><a href="UserModeling.html">UserModeling</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Accounts">Accounts</a></li><li><a href="global.html#App">App</a></li><li><a href="global.html#AuthForm">AuthForm</a></li><li><a href="global.html#Feature">Feature</a></li><li><a href="global.html#Features">Features</a></li><li><a href="global.html#Footer">Footer</a></li><li><a href="global.html#Guest">Guest</a></li><li><a href="global.html#Hero">Hero</a></li><li><a href="global.html#Home">Home</a></li><li><a href="global.html#Loader">Loader</a></li><li><a href="global.html#Login">Login</a></li><li><a href="global.html#Logo">Logo</a></li><li><a href="global.html#Nav">Nav</a></li><li><a href="global.html#PrivateRoutes">PrivateRoutes</a></li><li><a href="global.html#Profile">Profile</a></li><li><a href="global.html#ProfileForm">ProfileForm</a></li><li><a href="global.html#authMiddleware">authMiddleware</a></li><li><a href="global.html#deleteStorageToken">deleteStorageToken</a></li><li><a href="global.html#disconnectMiddleware">disconnectMiddleware</a></li><li><a href="global.html#editProfileMiddleware">editProfileMiddleware</a></li><li><a href="global.html#errorMiddleware">errorMiddleware</a></li><li><a href="global.html#fetchStatus">fetchStatus</a></li><li><a href="global.html#getProfileMiddleware">getProfileMiddleware</a></li><li><a href="global.html#getStorageTokenOrThrow">getStorageTokenOrThrow</a></li><li><a href="global.html#setStorageToken">setStorageToken</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Tue Mar 21 2023 08:52:43 GMT+0100 (heure normale d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
